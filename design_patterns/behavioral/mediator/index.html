<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mediator Pattern</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #3b82f6; /* Vibrant blue */
            --primary-dark: #2563eb;
            --primary-light: #60a5fa;
            --secondary-color: #10b981; /* Green */
            --secondary-dark: #059669;
            --accent-color: #8b5cf6; /* Purple */
            --accent-color-good: #059669; /* Green for good examples */
            --accent-color-bad: #ef4444; /* Red for bad examples */
            --text-color: #e2e8f0;
            --text-muted: #94a3b8;
            --bg-color: #0f172a; /* Dark blue background */
            --bg-light: #1e293b;
            --bg-lighter: #334155;
            --bg-card: #1e293b;
            --border-color: #334155;
            --code-bg: #0f172a;
            --code-text: #e2e8f0;
            --heading-font: 'Poppins', sans-serif;
            --body-font: 'Inter', sans-serif;
            --border-radius: 8px;
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.3);
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.2), 0 2px 4px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.3), 0 4px 6px -2px rgba(0, 0, 0, 0.2);
            --glow: 0 0 15px rgba(59, 130, 246, 0.5);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--body-font);
            line-height: 1.7;
            color: var(--text-color);
            background-color: var(--bg-color);
        }
        
        .hero {
            position: relative;
            min-height: 40vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            text-align: center;
            overflow: hidden;
            background: linear-gradient(135deg, #0f172a 0%, #1e3a8a 100%);
            padding: 3rem 1rem;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2000 1500"><rect fill="%23000000" width="2000" height="1500"/><defs><circle stroke="%23222" vector-effect="non-scaling-stroke" id="a" fill="none" stroke-width="5" r="315"/></defs><g transform="translate(1000 750)"><use stroke="%233b82f6" href="%23a" transform="rotate(60 0 0) scale(0.4 0.4)"/><use stroke="%233b82f6" href="%23a" transform="rotate(120 0 0) scale(0.5 0.5)"/><use stroke="%233b82f6" href="%23a" transform="rotate(180 0 0) scale(0.6 0.6)"/><use stroke="%233b82f6" href="%23a" transform="rotate(240 0 0) scale(0.7 0.7)"/><use stroke="%233b82f6" href="%23a" transform="rotate(300 0 0) scale(0.8 0.8)"/></g></svg>');
            background-size: cover;
            opacity: 0.1;
            animation: pulse 15s ease-in-out infinite alternate;
        }

        @keyframes pulse {
            0% { transform: scale(1); opacity: 0.1; }
            50% { transform: scale(1.05); opacity: 0.15; }
            100% { transform: scale(1); opacity: 0.1; }
        }

        .hero-content {
            position: relative;
            z-index: 10;
            max-width: 800px;
        }

        .hero h1 {
            font-family: var(--heading-font);
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 1rem;
            text-shadow: 0 0 30px rgba(59, 130, 246, 0.5);
        }

        .hero p {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto;
        }

        /* Shapes animation */
        .shapes {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            overflow: hidden;
        }

        .shape {
            position: absolute;
            opacity: 0.2;
            animation: float 15s infinite linear;
        }

        .shape-1 {
            top: 20%;
            left: 10%;
            width: 60px;
            height: 60px;
            border-radius: 41% 59% 37% 63% / 44% 67% 33% 56%;
            background-color: #10b981;
            animation-duration: 25s;
            box-shadow: 0 0 30px rgba(16, 185, 129, 0.4);
        }

        .shape-2 {
            top: 60%;
            right: 15%;
            width: 80px;
            height: 80px;
            border-radius: 73% 27% 59% 41% / 57% 43% 57% 43%;
            background-color: #8b5cf6;
            animation-duration: 30s;
            animation-delay: 2s;
            box-shadow: 0 0 30px rgba(139, 92, 246, 0.4);
        }

        @keyframes float {
            0% {
                transform: translate(0, 0) rotate(0deg);
            }
            25% {
                transform: translate(10px, 15px) rotate(90deg);
            }
            50% {
                transform: translate(5px, -10px) rotate(180deg);
            }
            75% {
                transform: translate(-10px, 5px) rotate(270deg);
            }
            100% {
                transform: translate(0, 0) rotate(360deg);
            }
        }

        /* Main Content */
        .main-content {
            position: relative;
            margin-top: -50px;
            padding-bottom: 4rem;
        }

        .container {
            width: 90%;
            max-width: 1000px;
            margin: 0 auto;
            padding: 3rem;
            background-color: var(--bg-light);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-lg);
            border: 1px solid var(--border-color);
        }

        /* Typography */
        h1, h2, h3 {
            font-family: var(--heading-font);
            color: var(--text-color);
        }

        h2 {
            font-size: 1.8rem;
            font-weight: 600;
            margin-top: 3rem;
            margin-bottom: 1.5rem;
            color: var(--primary-light);
        }

        h3 {
            font-size: 1.4rem;
            font-weight: 500;
            margin-top: 2rem;
            margin-bottom: 1rem;
        }

        p, li {
            margin-bottom: 1.5rem;
            color: var(--text-muted);
            font-size: 1.05rem;
            line-height: 1.8;
        }

        ul, ol {
            padding-left: 1.5rem;
            margin-bottom: 2rem;
        }

        li {
            margin-bottom: 0.5rem;
        }

        strong {
            color: var(--text-color);
            font-weight: 600;
        }

        /* Code styling */
        code {
            background-color: var(--code-bg);
            padding: 0.2em 0.4em;
            border-radius: 4px;
            font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
            font-size: 0.9em;
            color: #f87171;
            border: 1px solid var(--border-color);
        }

        pre {
            background-color: var(--code-bg);
            color: var(--code-text);
            padding: 1.5rem;
            border-radius: var(--border-radius);
            overflow-x: auto;
            margin: 2rem 0;
            font-size: 0.9rem;
            line-height: 1.6;
            border: 1px solid var(--border-color);
        }

        pre code {
            background: none;
            padding: 0;
            color: inherit;
            font-size: inherit;
            border: none;
        }

        /* Examples */
        .example {
            border: 1px solid var(--border-color);
            padding: 2rem;
            margin: 2.5rem 0;
            border-radius: var(--border-radius);
            background-color: var(--bg-light);
            box-shadow: var(--shadow-sm);
        }

        .visualization {
            display: flex;
            justify-content: center;
            margin: 2rem 0;
            overflow-x: auto;
            padding: 1rem;
        }

        .visualization svg {
            max-width: 100%;
        }
        
        /* Footer */
        footer {
            background-color: var(--bg-color);
            color: white;
            padding: 3rem 0;
            text-align: center;
            margin-top: 4rem;
            border-top: 1px solid var(--border-color);
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        .footer-content p {
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 0;
        }

        /* Interactive Demo */
        .interactive-demo {
            background-color: var(--bg-lighter);
            padding: 2rem;
            margin: 3rem 0;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            border: 1px solid var(--border-color);
        }

        .interactive-demo h3 {
            margin-top: 0;
            color: var(--primary-light);
        }

        /* Buttons */
        button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: var(--border-radius);
            font-family: var(--body-font);
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.2s, transform 0.1s, box-shadow 0.2s;
        }

        button:hover {
            background-color: var(--primary-dark);
            box-shadow: 0 0 15px rgba(59, 130, 246, 0.5);
        }

        button:active {
            transform: scale(0.98);
        }

        button:disabled {
            background-color: var(--bg-lighter);
            color: var(--text-muted);
            cursor: not-allowed;
        }

        /* Log output */
        .log-output {
            background-color: var(--bg-color);
            border: 1px solid var(--border-color);
            padding: 1.5rem;
            border-radius: var(--border-radius);
            margin-top: 1.5rem;
            height: 200px;
            overflow-y: auto;
            font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
        }

        .log-entry {
            margin-bottom: 0.5rem;
            border-bottom: 1px dashed var(--border-color);
            padding-bottom: 0.5rem;
        }

        .log-entry:last-child {
            margin-bottom: 0;
            border-bottom: none;
        }
    </style>
</head>
<body>
    <!-- Hero Section -->
    <section class="hero">
        <div class="shapes">
            <div class="shape shape-1"></div>
            <div class="shape shape-2"></div>
        </div>
        <div class="hero-content">
            <h1>Mediator Pattern</h1>
            <p>Define an object that encapsulates how a set of objects interact</p>
        </div>
    </section>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            <section class="content-section">
                <h2>Understanding the Mediator Pattern</h2>
                <p>The Mediator pattern is a behavioral design pattern that defines an object that encapsulates how a set of objects interact. By promoting loose coupling by keeping objects from referring to each other explicitly, it enables easier maintenance and extension of object interactions.</p>
                
                <h3>Problem</h3>
                <p>Imagine you're developing a complex user interface with many interrelated components, such as buttons, text fields, checkboxes, and so on. Here are some common challenges:</p>
                <ul>
                    <li>Every component needs to communicate with other components, creating complex dependencies.</li>
                    <li>Components are tightly coupled, making it difficult to reuse them in other contexts.</li>
                    <li>Changes to one component often require changes to many others.</li>
                    <li>The business logic is scattered across multiple components, making it hard to maintain.</li>
                </ul>
                
                <h3>Solution</h3>
                <p>The Mediator pattern suggests creating a mediator object that encapsulates all the interconnections between components. Instead of components communicating directly, they notify the mediator, which then communicates with the appropriate components.</p>
                
                <p>Benefits of this approach include:</p>
                <ul>
                    <li>Components only know about the mediator, not about each other, reducing coupling.</li>
                    <li>Complex interaction logic is centralized in the mediator, making it easier to understand and maintain.</li>
                    <li>Components can be reused in different contexts with different mediators.</li>
                    <li>New components can be added without changing existing ones.</li>
                </ul>
                
                <h3>Structure</h3>
                <div class="visualization">
                    <img src="../../images/mediator-pattern.svg" alt="Mediator Pattern Structure" width="800" height="500">
                </div>
                
                <h3>Participants</h3>
                <ul>
                    <li><strong>Mediator:</strong> Defines the interface for communication between components.</li>
                    <li><strong>Concrete Mediator:</strong> Implements the Mediator interface and coordinates communication between components. It typically maintains references to all components.</li>
                    <li><strong>Colleague:</strong> Defines the interface for components that communicate through the mediator.</li>
                    <li><strong>Concrete Colleagues:</strong> Implement the Colleague interface and communicate with other components through the mediator.</li>
                </ul>
                
                <h3>When to Use</h3>
                <p>Use the Mediator Pattern when:</p>
                <ul>
                    <li>A set of objects communicate in well-defined but complex ways, resulting in interdependencies that are hard to understand.</li>
                    <li>Reusing an object is difficult because it refers to and communicates with many other objects.</li>
                    <li>Behavior that's distributed among several classes should be customizable without a lot of subclassing.</li>
                    <li>You want to avoid tight coupling between many related objects.</li>
                </ul>
                
                <h3>Benefits</h3>
                <ul>
                    <li><strong>Reduced Coupling:</strong> Components don't need to know about each other, only about the mediator.</li>
                    <li><strong>Centralized Control:</strong> The interaction logic is contained in one place, the mediator.</li>
                    <li><strong>Simplified Object Protocols:</strong> Reduces the number of relationships between objects from many-to-many to many-to-one.</li>
                    <li><strong>Easier Maintenance:</strong> Changes to interaction logic are centralized in the mediator.</li>
                </ul>
                
                <h3>Real-World Uses</h3>
                <ul>
                    <li><strong>UI Development:</strong> Coordinating interactions between UI components like form elements.</li>
                    <li><strong>Air Traffic Control:</strong> Coordinating communication between planes (colleagues) through the control tower (mediator).</li>
                    <li><strong>Chat Applications:</strong> Managing communication between users through a chat server.</li>
                    <li><strong>Event Bus Systems:</strong> Facilitating communication between decoupled components through events.</li>
                    <li><strong>Middleware:</strong> Coordinating communication between different services in a distributed system.</li>
                </ul>
            </section>
            
            <section class="content-section">
                <h2>Implementation Example</h2>
                <p>Here's a JavaScript implementation of the Mediator pattern that demonstrates a smart home system where various devices communicate through a central mediator:</p>
                
                <pre><code class="language-javascript">// Mediator interface
class SmartHomeMediator {
    notify(sender, event) {}
}

// Concrete Mediator
class SmartHomeController extends SmartHomeMediator {
    constructor() {
        super();
        this.devices = {};
    }
    
    registerDevice(deviceName, device) {
        this.devices[deviceName] = device;
        device.setMediator(this);
    }
    
    notify(sender, event) {
        console.log(`Mediator: Handling '${event}' event from ${sender.name}`);
        
        if (sender instanceof MotionSensor && event === 'motion_detected') {
            // Turn on lights when motion is detected if it's dark
            if (this.devices['light_sensor'].currentLightLevel < 20) {
                this.devices['living_room_light'].turnOn();
                this.devices['hallway_light'].turnOn();
            }
        }
        
        if (sender instanceof LightSensor && event === 'light_changed') {
            // Adjust blinds based on light level
            if (sender.currentLightLevel > 80) {
                this.devices['living_room_blinds'].close();
            } else if (sender.currentLightLevel < 20) {
                this.devices['living_room_blinds'].open();
            }
        }
        
        if (sender instanceof Thermostat && event === 'temperature_changed') {
            // Adjust AC or heater based on temperature
            if (sender.currentTemperature > 25) {
                this.devices['air_conditioner'].turnOn();
                this.devices['heater'].turnOff();
            } else if (sender.currentTemperature < 18) {
                this.devices['heater'].turnOn();
                this.devices['air_conditioner'].turnOff();
            } else {
                this.devices['air_conditioner'].turnOff();
                this.devices['heater'].turnOff();
            }
        }
        
        if (event === 'leaving_home') {
            // Secure the house when leaving
            Object.values(this.devices).forEach(device => {
                if (device instanceof Light) {
                    device.turnOff();
                }
                if (device instanceof AirConditioner) {
                    device.turnOff();
                }
                if (device instanceof Heater) {
                    device.turnOff();
                }
            });
            this.devices['security_system'].arm();
        }
        
        if (event === 'returning_home') {
            // Welcome back mode
            this.devices['security_system'].disarm();
            if (this.devices['light_sensor'].currentLightLevel < 50) {
                this.devices['living_room_light'].turnOn();
                this.devices['hallway_light'].turnOn();
            }
        }
    }
}

// Base Colleague class
class SmartDevice {
    constructor(name) {
        this.name = name;
        this.mediator = null;
    }
    
    setMediator(mediator) {
        this.mediator = mediator;
    }
}

// Concrete Colleagues
class Light extends SmartDevice {
    constructor(name) {
        super(name);
        this.isOn = false;
    }
    
    turnOn() {
        if (!this.isOn) {
            this.isOn = true;
            console.log(`${this.name}: Light turned ON`);
        }
    }
    
    turnOff() {
        if (this.isOn) {
            this.isOn = false;
            console.log(`${this.name}: Light turned OFF`);
        }
    }
    
    toggle() {
        this.isOn ? this.turnOff() : this.turnOn();
        this.mediator.notify(this, this.isOn ? 'light_on' : 'light_off');
    }
}

class MotionSensor extends SmartDevice {
    constructor(name) {
        super(name);
    }
    
    detectMotion() {
        console.log(`${this.name}: Motion detected!`);
        this.mediator.notify(this, 'motion_detected');
    }
}

class LightSensor extends SmartDevice {
    constructor(name) {
        super(name);
        this.currentLightLevel = 50; // default 0-100
    }
    
    setLightLevel(level) {
        this.currentLightLevel = level;
        console.log(`${this.name}: Light level set to ${level}`);
        this.mediator.notify(this, 'light_changed');
    }
}

class Thermostat extends SmartDevice {
    constructor(name) {
        super(name);
        this.currentTemperature = 22; // default in Celsius
    }
    
    setTemperature(temperature) {
        this.currentTemperature = temperature;
        console.log(`${this.name}: Temperature set to ${temperature}¬∞C`);
        this.mediator.notify(this, 'temperature_changed');
    }
}

class AirConditioner extends SmartDevice {
    constructor(name) {
        super(name);
        this.isOn = false;
    }
    
    turnOn() {
        if (!this.isOn) {
            this.isOn = true;
            console.log(`${this.name}: AC turned ON`);
        }
    }
    
    turnOff() {
        if (this.isOn) {
            this.isOn = false;
            console.log(`${this.name}: AC turned OFF`);
        }
    }
}

class Heater extends SmartDevice {
    constructor(name) {
        super(name);
        this.isOn = false;
    }
    
    turnOn() {
        if (!this.isOn) {
            this.isOn = true;
            console.log(`${this.name}: Heater turned ON`);
        }
    }
    
    turnOff() {
        if (this.isOn) {
            this.isOn = false;
            console.log(`${this.name}: Heater turned OFF`);
        }
    }
}

class Blinds extends SmartDevice {
    constructor(name) {
        super(name);
        this.isOpen = true;
    }
    
    open() {
        if (!this.isOpen) {
            this.isOpen = true;
            console.log(`${this.name}: Blinds OPENED`);
        }
    }
    
    close() {
        if (this.isOpen) {
            this.isOpen = false;
            console.log(`${this.name}: Blinds CLOSED`);
        }
    }
}

class SecuritySystem extends SmartDevice {
    constructor(name) {
        super(name);
        this.isArmed = false;
    }
    
    arm() {
        if (!this.isArmed) {
            this.isArmed = true;
            console.log(`${this.name}: Security system ARMED`);
        }
    }
    
    disarm() {
        if (this.isArmed) {
            this.isArmed = false;
            console.log(`${this.name}: Security system DISARMED`);
        }
    }
    
    triggerAlarm() {
        if (this.isArmed) {
            console.log(`${this.name}: üö® ALARM TRIGGERED! üö®`);
            this.mediator.notify(this, 'alarm_triggered');
        }
    }
}

// Client code
function clientDemo() {
    const mediator = new SmartHomeController();
    
    // Create devices
    const livingRoomLight = new Light("Living Room Light");
    const hallwayLight = new Light("Hallway Light");
    const motionSensor = new MotionSensor("Motion Sensor");
    const lightSensor = new LightSensor("Light Sensor");
    const thermostat = new Thermostat("Thermostat");
    const ac = new AirConditioner("Air Conditioner");
    const heater = new Heater("Heater");
    const blinds = new Blinds("Living Room Blinds");
    const securitySystem = new SecuritySystem("Security System");
    
    // Register all devices with the mediator
    mediator.registerDevice('living_room_light', livingRoomLight);
    mediator.registerDevice('hallway_light', hallwayLight);
    mediator.registerDevice('motion_sensor', motionSensor);
    mediator.registerDevice('light_sensor', lightSensor);
    mediator.registerDevice('thermostat', thermostat);
    mediator.registerDevice('air_conditioner', ac);
    mediator.registerDevice('heater', heater);
    mediator.registerDevice('living_room_blinds', blinds);
    mediator.registerDevice('security_system', securitySystem);
    
    // Simulate different scenarios
    console.log("=== Evening Scenario: Motion Detected ===");
    lightSensor.setLightLevel(10); // Dark outside
    motionSensor.detectMotion();
    
    console.log("\n=== Hot Day Scenario ===");
    lightSensor.setLightLevel(90); // Bright sunny day
    thermostat.setTemperature(28); // It's hot
    
    console.log("\n=== Leaving Home Scenario ===");
    mediator.notify({ name: "Mobile App" }, "leaving_home");
    
    console.log("\n=== Returning Home Scenario ===");
    mediator.notify({ name: "Mobile App" }, "returning_home");
    
    console.log("\n=== Cold Evening Scenario ===");
    lightSensor.setLightLevel(5); // Very dark outside
    thermostat.setTemperature(16); // It's cold
}

// Run the demo
clientDemo();</code></pre>

                <p>In this example:</p>
                <ul>
                    <li>The <code>SmartHomeMediator</code> defines the interface for the mediator.</li>
                    <li>The <code>SmartHomeController</code> is the concrete mediator that coordinates all communication between smart devices.</li>
                    <li>The <code>SmartDevice</code> is the base colleague class that all devices inherit from.</li>
                    <li>Various concrete colleagues (Light, MotionSensor, etc.) interact through the mediator rather than directly with each other.</li>
                    <li>Devices notify the mediator of events (like motion detection or temperature changes), and the mediator determines how other devices should respond.</li>
                </ul>
                
                <p>This design decouples the devices from each other, centralizing all coordination logic in the mediator. This makes the system much easier to maintain and extend - adding a new device or changing the behavior of existing devices requires changes only to the mediator, not to the devices themselves.</p>
            </section>
            
            <section class="content-section interactive-demo-section">
                <h2>Interactive Demo</h2>
                <p>Experience the Mediator pattern in action with this interactive smart home simulation. Try triggering different events and see how the mediator coordinates the responses between devices.</p>
                
                <div class="interactive-demo">
                    <h3>Interactive Smart Home System</h3>
                    <p>Control various smart devices and see how they communicate through the mediator.</p>
                    
                    <div id="smart-home-demo">
                        <div class="devices-container">
                            <div class="device-group">
                                <h4>Sensors</h4>
                                <div class="device-card" id="motion-sensor">
                                    <div class="device-icon">üì°</div>
                                    <div class="device-name">Motion Sensor</div>
                                    <div class="device-controls">
                                        <button id="trigger-motion">Trigger Motion</button>
                                    </div>
                                </div>
                                
                                <div class="device-card" id="light-sensor">
                                    <div class="device-icon">‚òÄÔ∏è</div>
                                    <div class="device-name">Light Sensor</div>
                                    <div class="device-controls">
                                        <label>Light Level: <span id="light-level-value">50</span>%</label>
                                        <input type="range" id="light-level" min="0" max="100" value="50">
                                    </div>
                                </div>
                                
                                <div class="device-card" id="thermostat">
                                    <div class="device-icon">üå°Ô∏è</div>
                                    <div class="device-name">Thermostat</div>
                                    <div class="device-controls">
                                        <label>Temperature: <span id="temperature-value">22</span>¬∞C</label>
                                        <input type="range" id="temperature" min="10" max="35" value="22">
                                    </div>
                                </div>
                            </div>
                            
                            <div class="device-group">
                                <h4>Lights</h4>
                                <div class="device-card" id="living-room-light">
                                    <div class="device-icon">üí°</div>
                                    <div class="device-name">Living Room Light</div>
                                    <div class="device-status">OFF</div>
                                </div>
                                
                                <div class="device-card" id="hallway-light">
                                    <div class="device-icon">üí°</div>
                                    <div class="device-name">Hallway Light</div>
                                    <div class="device-status">OFF</div>
                                </div>
                            </div>
                            
                            <div class="device-group">
                                <h4>Climate & Security</h4>
                                <div class="device-card" id="air-conditioner">
                                    <div class="device-icon">‚ùÑÔ∏è</div>
                                    <div class="device-name">Air Conditioner</div>
                                    <div class="device-status">OFF</div>
                                </div>
                                
                                <div class="device-card" id="heater">
                                    <div class="device-icon">üî•</div>
                                    <div class="device-name">Heater</div>
                                    <div class="device-status">OFF</div>
                                </div>
                                
                                <div class="device-card" id="blinds">
                                    <div class="device-icon">ü™ü</div>
                                    <div class="device-name">Blinds</div>
                                    <div class="device-status">OPEN</div>
                                </div>
                                
                                <div class="device-card" id="security-system">
                                    <div class="device-icon">üîí</div>
                                    <div class="device-name">Security System</div>
                                    <div class="device-status">DISARMED</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="scenario-controls">
                            <h4>Scenarios</h4>
                            <button id="leaving-home">Leaving Home</button>
                            <button id="returning-home">Returning Home</button>
                        </div>
                        
                        <div class="log-output" id="mediator-log">
                            <div class="log-entry">Smart Home System initialized. Try changing settings or triggering events!</div>
                        </div>
                    </div>
                </div>
                
                <style>
                    .devices-container {
                        display: grid;
                        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
                        gap: 1.5rem;
                        margin-bottom: 2rem;
                    }
                    
                    .device-group {
                        background-color: var(--bg-color);
                        border-radius: var(--border-radius);
                        padding: 1.5rem;
                        border: 1px solid var(--border-color);
                    }
                    
                    .device-group h4 {
                        margin-top: 0;
                        margin-bottom: 1rem;
                        border-bottom: 1px solid var(--border-color);
                        padding-bottom: 0.5rem;
                    }
                    
                    .device-card {
                        background-color: var(--bg-lighter);
                        border-radius: var(--border-radius);
                        padding: 1rem;
                        margin-bottom: 1rem;
                        display: flex;
                        flex-direction: column;
                        align-items: center;
                        transition: all 0.3s ease;
                    }
                    
                    .device-card:last-child {
                        margin-bottom: 0;
                    }
                    
                    .device-icon {
                        font-size: 2rem;
                        margin-bottom: 0.5rem;
                    }
                    
                    .device-name {
                        font-weight: 600;
                        margin-bottom: 0.5rem;
                    }
                    
                    .device-status {
                        font-size: 0.9rem;
                        color: var(--text-muted);
                        padding: 0.25rem 0.75rem;
                        border-radius: 20px;
                        background-color: var(--bg-color);
                    }
                    
                    .device-status.on {
                        background-color: rgba(16, 185, 129, 0.2);
                        color: var(--secondary-color);
                    }
                    
                    .device-status.off {
                        background-color: rgba(239, 68, 68, 0.2);
                        color: #ef4444;
                    }
                    
                    .device-controls {
                        width: 100%;
                        margin-top: 0.5rem;
                        display: flex;
                        flex-direction: column;
                    }
                    
                    .device-controls label {
                        margin-bottom: 0.5rem;
                        font-size: 0.9rem;
                    }
                    
                    .device-controls input[type="range"] {
                        width: 100%;
                        margin-bottom: 0.5rem;
                    }
                    
                    .scenario-controls {
                        margin: 2rem 0;
                        display: flex;
                        flex-wrap: wrap;
                        gap: 1rem;
                        align-items: center;
                    }
                    
                    .scenario-controls h4 {
                        margin: 0;
                        margin-right: 1rem;
                    }
                    
                    .log-output {
                        height: 250px;
                    }
                </style>
            </section>
        </div>
    </main>

    <footer>
        <div class="footer-content">
            <p>&copy; 2025 Design Patterns Interactive Guide</p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Mediator Interface
            class SmartHomeMediator {
                notify(sender, event) {}
            }
            
            // Concrete Mediator
            class SmartHomeController extends SmartHomeMediator {
                constructor() {
                    super();
                    this.devices = {};
                }
                
                registerDevice(deviceName, device) {
                    this.devices[deviceName] = device;
                    device.setMediator(this);
                }
                
                notify(sender, event) {
                    this.log(`Mediator: Handling '${event}' event from ${sender.name}`);
                    
                    if (sender.constructor.name === 'MotionSensor' && event === 'motion_detected') {
                        // Turn on lights when motion is detected if it's dark
                        if (this.devices['light_sensor'].currentLightLevel < 20) {
                            this.devices['living_room_light'].turnOn();
                            this.devices['hallway_light'].turnOn();
                        }
                    }
                    
                    if (sender.constructor.name === 'LightSensor' && event === 'light_changed') {
                        // Adjust blinds based on light level
                        if (sender.currentLightLevel > 80) {
                            this.devices['blinds'].close();
                        } else if (sender.currentLightLevel < 20) {
                            this.devices['blinds'].open();
                        }
                    }
                    
                    if (sender.constructor.name === 'Thermostat' && event === 'temperature_changed') {
                        // Adjust AC or heater based on temperature
                        if (sender.currentTemperature > 25) {
                            this.devices['air_conditioner'].turnOn();
                            this.devices['heater'].turnOff();
                        } else if (sender.currentTemperature < 18) {
                            this.devices['heater'].turnOn();
                            this.devices['air_conditioner'].turnOff();
                        } else {
                            this.devices['air_conditioner'].turnOff();
                            this.devices['heater'].turnOff();
                        }
                    }
                    
                    if (event === 'leaving_home') {
                        // Secure the house when leaving
                        this.devices['living_room_light'].turnOff();
                        this.devices['hallway_light'].turnOff();
                        this.devices['air_conditioner'].turnOff();
                        this.devices['heater'].turnOff();
                        this.devices['security_system'].arm();
                    }
                    
                    if (event === 'returning_home') {
                        // Welcome back mode
                        this.devices['security_system'].disarm();
                        if (this.devices['light_sensor'].currentLightLevel < 50) {
                            this.devices['living_room_light'].turnOn();
                            this.devices['hallway_light'].turnOn();
                        }
                    }
                }
                
                log(message) {
                    const logOutput = document.getElementById('mediator-log');
                    const logEntry = document.createElement('div');
                    logEntry.classList.add('log-entry');
                    logEntry.textContent = message;
                    logOutput.appendChild(logEntry);
                    logOutput.scrollTop = logOutput.scrollHeight;
                }
            }
            
            // Base Colleague class
            class SmartDevice {
                constructor(name) {
                    this.name = name;
                    this.mediator = null;
                }
                
                setMediator(mediator) {
                    this.mediator = mediator;
                }
            }
            
            // Concrete Colleagues
            class Light extends SmartDevice {
                constructor(name, elementId) {
                    super(name);
                    this.isOn = false;
                    this.elementId = elementId;
                }
                
                turnOn() {
                    if (!this.isOn) {
                        this.isOn = true;
                        this.updateUI();
                        this.mediator.log(`${this.name}: Light turned ON`);
                    }
                }
                
                turnOff() {
                    if (this.isOn) {
                        this.isOn = false;
                        this.updateUI();
                        this.mediator.log(`${this.name}: Light turned OFF`);
                    }
                }
                
                updateUI() {
                    const element = document.getElementById(this.elementId);
                    const statusElement = element.querySelector('.device-status');
                    statusElement.textContent = this.isOn ? 'ON' : 'OFF';
                    statusElement.className = 'device-status';
                    statusElement.classList.add(this.isOn ? 'on' : 'off');
                }
            }
            
            class MotionSensor extends SmartDevice {
                constructor(name, elementId) {
                    super(name);
                    this.elementId = elementId;
                }
                
                detectMotion() {
                    this.mediator.log(`${this.name}: Motion detected!`);
                    this.mediator.notify(this, 'motion_detected');
                }
            }
            
            class LightSensor extends SmartDevice {
                constructor(name, elementId) {
                    super(name);
                    this.currentLightLevel = 50; // default 0-100
                    this.elementId = elementId;
                }
                
                setLightLevel(level) {
                    this.currentLightLevel = level;
                    document.getElementById('light-level-value').textContent = level;
                    this.mediator.log(`${this.name}: Light level set to ${level}%`);
                    this.mediator.notify(this, 'light_changed');
                }
            }
            
            class Thermostat extends SmartDevice {
                constructor(name, elementId) {
                    super(name);
                    this.currentTemperature = 22; // default in Celsius
                    this.elementId = elementId;
                }
                
                setTemperature(temperature) {
                    this.currentTemperature = temperature;
                    document.getElementById('temperature-value').textContent = temperature;
                    this.mediator.log(`${this.name}: Temperature set to ${temperature}¬∞C`);
                    this.mediator.notify(this, 'temperature_changed');
                }
            }
            
            class AirConditioner extends SmartDevice {
                constructor(name, elementId) {
                    super(name);
                    this.isOn = false;
                    this.elementId = elementId;
                }
                
                turnOn() {
                    if (!this.isOn) {
                        this.isOn = true;
                        this.updateUI();
                        this.mediator.log(`${this.name}: AC turned ON`);
                    }
                }
                
                turnOff() {
                    if (this.isOn) {
                        this.isOn = false;
                        this.updateUI();
                        this.mediator.log(`${this.name}: AC turned OFF`);
                    }
                }
                
                updateUI() {
                    const element = document.getElementById(this.elementId);
                    const statusElement = element.querySelector('.device-status');
                    statusElement.textContent = this.isOn ? 'ON' : 'OFF';
                    statusElement.className = 'device-status';
                    statusElement.classList.add(this.isOn ? 'on' : 'off');
                }
            }
            
            class Heater extends SmartDevice {
                constructor(name, elementId) {
                    super(name);
                    this.isOn = false;
                    this.elementId = elementId;
                }
                
                turnOn() {
                    if (!this.isOn) {
                        this.isOn = true;
                        this.updateUI();
                        this.mediator.log(`${this.name}: Heater turned ON`);
                    }
                }
                
                turnOff() {
                    if (this.isOn) {
                        this.isOn = false;
                        this.updateUI();
                        this.mediator.log(`${this.name}: Heater turned OFF`);
                    }
                }
                
                updateUI() {
                    const element = document.getElementById(this.elementId);
                    const statusElement = element.querySelector('.device-status');
                    statusElement.textContent = this.isOn ? 'ON' : 'OFF';
                    statusElement.className = 'device-status';
                    statusElement.classList.add(this.isOn ? 'on' : 'off');
                }
            }
            
            class Blinds extends SmartDevice {
                constructor(name, elementId) {
                    super(name);
                    this.isOpen = true;
                    this.elementId = elementId;
                }
                
                open() {
                    if (!this.isOpen) {
                        this.isOpen = true;
                        this.updateUI();
                        this.mediator.log(`${this.name}: Blinds OPENED`);
                    }
                }
                
                close() {
                    if (this.isOpen) {
                        this.isOpen = false;
                        this.updateUI();
                        this.mediator.log(`${this.name}: Blinds CLOSED`);
                    }
                }
                
                updateUI() {
                    const element = document.getElementById(this.elementId);
                    const statusElement = element.querySelector('.device-status');
                    statusElement.textContent = this.isOpen ? 'OPEN' : 'CLOSED';
                    statusElement.className = 'device-status';
                    statusElement.classList.add(this.isOpen ? 'on' : 'off');
                }
            }
            
            class SecuritySystem extends SmartDevice {
                constructor(name, elementId) {
                    super(name);
                    this.isArmed = false;
                    this.elementId = elementId;
                }
                
                arm() {
                    if (!this.isArmed) {
                        this.isArmed = true;
                        this.updateUI();
                        this.mediator.log(`${this.name}: Security system ARMED`);
                    }
                }
                
                disarm() {
                    if (this.isArmed) {
                        this.isArmed = false;
                        this.updateUI();
                        this.mediator.log(`${this.name}: Security system DISARMED`);
                    }
                }
                
                updateUI() {
                    const element = document.getElementById(this.elementId);
                    const statusElement = element.querySelector('.device-status');
                    statusElement.textContent = this.isArmed ? 'ARMED' : 'DISARMED';
                    statusElement.className = 'device-status';
                    statusElement.classList.add(this.isArmed ? 'on' : 'off');
                }
            }
            
            // Initialize the demo
            function initDemo() {
                const mediator = new SmartHomeController();
                
                // Create devices
                const livingRoomLight = new Light("Living Room Light", "living-room-light");
                const hallwayLight = new Light("Hallway Light", "hallway-light");
                const motionSensor = new MotionSensor("Motion Sensor", "motion-sensor");
                const lightSensor = new LightSensor("Light Sensor", "light-sensor");
                const thermostat = new Thermostat("Thermostat", "thermostat");
                const airConditioner = new AirConditioner("Air Conditioner", "air-conditioner");
                const heater = new Heater("Heater", "heater");
                const blinds = new Blinds("Living Room Blinds", "blinds");
                const securitySystem = new SecuritySystem("Security System", "security-system");
                
                // Register all devices with the mediator
                mediator.registerDevice('living_room_light', livingRoomLight);
                mediator.registerDevice('hallway_light', hallwayLight);
                mediator.registerDevice('motion_sensor', motionSensor);
                mediator.registerDevice('light_sensor', lightSensor);
                mediator.registerDevice('thermostat', thermostat);
                mediator.registerDevice('air_conditioner', airConditioner);
                mediator.registerDevice('heater', heater);
                mediator.registerDevice('blinds', blinds);
                mediator.registerDevice('security_system', securitySystem);
                
                // Set up event listeners
                document.getElementById('trigger-motion').addEventListener('click', function() {
                    motionSensor.detectMotion();
                });
                
                document.getElementById('light-level').addEventListener('input', function(e) {
                    lightSensor.setLightLevel(parseInt(e.target.value));
                });
                
                document.getElementById('temperature').addEventListener('input', function(e) {
                    thermostat.setTemperature(parseInt(e.target.value));
                });
                
                document.getElementById('leaving-home').addEventListener('click', function() {
                    mediator.notify({ name: "User Interface" }, "leaving_home");
                });
                
                document.getElementById('returning-home').addEventListener('click', function() {
                    mediator.notify({ name: "User Interface" }, "returning_home");
                });
                
                mediator.log("Smart Home System initialized. Try changing settings or triggering events!");
            }
            
            // Start the demo
            initDemo();
        });
    </script>
</body>
</html> 